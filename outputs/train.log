0: WARNING 25-07-08 21:41:58.716053 - 0:00:00 - Signal handler installed.
0: WARNING 25-07-08 21:41:58.725425 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 25-07-08 21:41:58.725806 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 25-07-08 21:41:58.726038 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 0
0: WARNING 25-07-08 21:41:58.726225 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 25-07-08 21:41:58.726419 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 25-07-08 21:41:58.726582 - 0:00:00 - WARNING: Setting NCCL_DEBUG to WARN
0: WARNING 25-07-08 21:41:58.726753 - 0:00:00 - WARNING: Setting PYTORCH_CUDA_ALLOC_CONF to expandable_segments:True
0: WARNING 25-07-08 21:41:58.726974 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /tmp/tmpco8vd3vy
0: INFO    25-07-08 21:42:06.537541 - 0:00:08 - Run launched with torchrun, local rank: 0
0: INFO    25-07-08 21:42:06.538222 - 0:00:08 - ENV: environ({'SHELL': '/bin/bash', 'COLORTERM': 'truecolor', 'TERM_PROGRAM_VERSION': '1.101.2', 'CONDA_EXE': '/home/oberon/anaconda3/bin/conda', '_CE_M': '', 'LANGUAGE': 'en_GB:en', 'XML_CATALOG_FILES': 'file:///home/oberon/anaconda3/envs/perception_models/etc/xml/catalog file:///etc/xml/catalog', 'PIP_NO_USER': '1', 'PWD': '/home/oberon/projects/perception_models', 'GSETTINGS_SCHEMA_DIR': '/home/oberon/anaconda3/envs/perception_models/share/glib-2.0/schemas', 'LOGNAME': 'oberon', 'XDG_SESSION_TYPE': 'tty', 'CONDA_PREFIX': '/home/oberon/anaconda3/envs/perception_models', 'GSETTINGS_SCHEMA_DIR_CONDA_BACKUP': '', 'VSCODE_GIT_ASKPASS_NODE': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/node', 'MOTD_SHOWN': 'pam', 'HOME': '/home/oberon', 'LANG': 'en_GB.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSL_CERT_DIR': '/usr/lib/ssl/certs', 'CONDA_PROMPT_MODIFIER': '(perception_models) ', 'GIT_ASKPASS': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/extensions/git/dist/askpass.sh', 'SSH_CONNECTION': '192.168.82.204 49630 131.227.186.152 22', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'XDG_SESSION_CLASS': 'user', 'TERM': 'xterm-256color', '_CE_CONDA': '', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'oberon', 'VSCODE_GIT_IPC_HANDLE': '/run/user/1012/vscode-git-d917f49fae.sock', 'CONDA_SHLVL': '2', 'SHLVL': '2', 'XDG_SESSION_ID': '706', 'CONDA_PYTHON_EXE': '/home/oberon/anaconda3/bin/python', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.9/lib64:/usr/local/cuda-11.8/lib64:', 'XDG_RUNTIME_DIR': '/run/user/1012', 'SSL_CERT_FILE': '/usr/lib/ssl/certs/ca-certificates.crt', 'SSH_CLIENT': '192.168.82.204 49630 22', 'CONDA_DEFAULT_ENV': 'perception_models', 'VSCODE_GIT_ASKPASS_MAIN': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/usr/local/cuda-12.9', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'BROWSER': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/bin/helpers/browser.sh', 'PATH': '/usr/local/cuda-12.9/bin:/usr/local/cuda-11.8/bin:/home/oberon/anaconda3/envs/perception_models/bin:/home/oberon/anaconda3/condabin:/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/bin/remote-cli:/home/oberon/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/oberon/.vscode-server/data/User/globalStorage/github.copilot-chat/debugCommand', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/1012/bus', 'CONDA_PREFIX_1': '/home/oberon/anaconda3', 'TERM_PROGRAM': 'vscode', 'VSCODE_IPC_HOOK_CLI': '/run/user/1012/vscode-ipc-8f97b332-6577-40f8-b722-7d60be3f5e0a.sock', '_': '/home/oberon/anaconda3/envs/perception_models/bin/torchrun', 'OMP_NUM_THREADS': '1', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '2', 'WORLD_SIZE': '2', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '2', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29500', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/tmp/torchelastic_qk1ob_cf/none_yr9cptu8/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '0', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'WARN', 'PYTORCH_CUDA_ALLOC_CONF': 'expandable_segments:True', 'TRITON_CACHE_DIR': '/tmp/tmpco8vd3vy'})
0: INFO    25-07-08 21:42:06.564165 - 0:00:08 - Starting job: plm_3b_stage3
0: INFO    25-07-08 21:42:06.565478 - 0:00:08 - Running on dp rank : 0
0: INFO    25-07-08 21:42:06.565744 - 0:00:08 - Running on dp size : 2
0: INFO    25-07-08 21:42:06.567914 - 0:00:08 - Building model
0: INFO    25-07-08 21:42:06.669489 - 0:00:08 - Initializing PE_VisionTransformer with args: {'image_size': 448, 'patch_size': 14, 'width': 1024, 'layers': 23, 'heads': 16, 'use_cls_token': True, 'use_abs_posemb': True, 'mlp_ratio': 4.0, 'ls_init_value': 0.1, 'drop_path': 0.1, 'use_ln_post': False, 'pool_type': 'none'}
0: INFO    25-07-08 21:42:06.691859 - 0:00:08 - Model is built !
0: INFO    25-07-08 21:42:06.826321 - 0:00:08 - Loading initial model from /home/oberon/.cache/huggingface/hub/models--facebook--Perception-LM-3B/snapshots/b54263fbbb6f7590c89b9c3036a9a9d03ad8441f
0: INFO    25-07-08 21:42:13.228143 - 0:00:15 - Model size: 3,516,753,920 total parameters
0: INFO    25-07-08 21:42:13.235448 - 0:00:15 - GPU capacity: NVIDIA GeForce RTX 3090 (0) with 23.55GiB memory
0: INFO    25-07-08 21:42:13.236817 - 0:00:15 - GPU memory usage: NVIDIA GeForce RTX 3090 (0): 23.551025390625 GiB capacity, 16.37890625 GiB peak, 69.5464676307469% peak
0: INFO    25-07-08 21:42:13.236869 - 0:00:15 - Starting build of optimizer...
0: INFO    25-07-08 21:42:13.238438 - 0:00:15 - Done with build of optimizer.
0: INFO    25-07-08 21:42:13.238492 - 0:00:15 - VariableSizeImageTransform size: 448
0: INFO    25-07-08 21:42:13.238587 - 0:00:15 - ImageTransform size: 448
0: INFO    25-07-08 21:42:13.238641 - 0:00:15 - Initalized transforms with: vision_input_type: 'thumb+tile' and max_num_tiles: 36.
0: INFO    25-07-08 21:42:13.238672 - 0:00:15 - ImageTransform size: 448
0: INFO    25-07-08 21:42:13.281586 - 0:00:15 - Initializing JSONLDataset dummy_image on dataloader rank 0 and world size 8
0: INFO    25-07-08 21:42:13.339641 - 0:00:15 - Starting iteration 0 over apps/plm/datasets/image/annotations.jsonl ...
0: INFO    25-07-08 21:42:13.487817 - 0:00:15 - Logging Trainable Parameters after first step.
0: INFO    25-07-08 21:42:13.488050 - 0:00:15 - Params total: 3,516,753,920, Learnable: 304,004,096, Frozen: 3,212,749,824.
0: INFO    25-07-08 21:42:15.269607 - 0:00:17 - garbage collection
0: WARNING 25-07-08 21:46:05.930296 - 0:00:00 - Signal handler installed.
0: WARNING 25-07-08 21:46:05.930468 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 25-07-08 21:46:05.930531 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 25-07-08 21:46:05.930593 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 0
0: WARNING 25-07-08 21:46:05.930635 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 25-07-08 21:46:05.930677 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 25-07-08 21:46:05.930713 - 0:00:00 - WARNING: Setting NCCL_DEBUG to WARN
0: WARNING 25-07-08 21:46:05.930746 - 0:00:00 - WARNING: Setting PYTORCH_CUDA_ALLOC_CONF to expandable_segments:True
0: WARNING 25-07-08 21:46:05.930778 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /tmp/tmp_lew70kq
0: INFO    25-07-08 21:46:08.273387 - 0:00:02 - Run launched with torchrun, local rank: 0
0: INFO    25-07-08 21:46:08.273558 - 0:00:02 - ENV: environ({'SHELL': '/bin/bash', 'COLORTERM': 'truecolor', 'TERM_PROGRAM_VERSION': '1.101.2', 'CONDA_EXE': '/home/oberon/anaconda3/bin/conda', '_CE_M': '', 'LANGUAGE': 'en_GB:en', 'XML_CATALOG_FILES': 'file:///home/oberon/anaconda3/envs/perception_models/etc/xml/catalog file:///etc/xml/catalog', 'PIP_NO_USER': '1', 'PWD': '/home/oberon/projects/perception_models', 'GSETTINGS_SCHEMA_DIR': '/home/oberon/anaconda3/envs/perception_models/share/glib-2.0/schemas', 'LOGNAME': 'oberon', 'XDG_SESSION_TYPE': 'tty', 'CONDA_PREFIX': '/home/oberon/anaconda3/envs/perception_models', 'GSETTINGS_SCHEMA_DIR_CONDA_BACKUP': '', 'VSCODE_GIT_ASKPASS_NODE': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/node', 'MOTD_SHOWN': 'pam', 'HOME': '/home/oberon', 'LANG': 'en_GB.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSL_CERT_DIR': '/usr/lib/ssl/certs', 'CONDA_PROMPT_MODIFIER': '(perception_models) ', 'GIT_ASKPASS': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/extensions/git/dist/askpass.sh', 'SSH_CONNECTION': '192.168.82.204 49630 131.227.186.152 22', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'XDG_SESSION_CLASS': 'user', 'TERM': 'xterm-256color', '_CE_CONDA': '', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'oberon', 'VSCODE_GIT_IPC_HANDLE': '/run/user/1012/vscode-git-d917f49fae.sock', 'CONDA_SHLVL': '2', 'SHLVL': '2', 'XDG_SESSION_ID': '706', 'CONDA_PYTHON_EXE': '/home/oberon/anaconda3/bin/python', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.9/lib64:/usr/local/cuda-11.8/lib64:', 'XDG_RUNTIME_DIR': '/run/user/1012', 'SSL_CERT_FILE': '/usr/lib/ssl/certs/ca-certificates.crt', 'SSH_CLIENT': '192.168.82.204 49630 22', 'CONDA_DEFAULT_ENV': 'perception_models', 'VSCODE_GIT_ASKPASS_MAIN': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/usr/local/cuda-12.9', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'BROWSER': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/bin/helpers/browser.sh', 'PATH': '/usr/local/cuda-12.9/bin:/usr/local/cuda-11.8/bin:/home/oberon/anaconda3/envs/perception_models/bin:/home/oberon/anaconda3/condabin:/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/bin/remote-cli:/home/oberon/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/oberon/.vscode-server/data/User/globalStorage/github.copilot-chat/debugCommand', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/1012/bus', 'CONDA_PREFIX_1': '/home/oberon/anaconda3', 'TERM_PROGRAM': 'vscode', 'VSCODE_IPC_HOOK_CLI': '/run/user/1012/vscode-ipc-8f97b332-6577-40f8-b722-7d60be3f5e0a.sock', '_': '/home/oberon/anaconda3/envs/perception_models/bin/torchrun', 'OMP_NUM_THREADS': '1', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '2', 'WORLD_SIZE': '2', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '2', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29500', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/tmp/torchelastic_scg_8xwd/none_vvff9f4c/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '0', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'WARN', 'PYTORCH_CUDA_ALLOC_CONF': 'expandable_segments:True', 'TRITON_CACHE_DIR': '/tmp/tmp_lew70kq'})
0: INFO    25-07-08 21:46:08.292564 - 0:00:02 - Starting job: plm_3b_stage3
0: INFO    25-07-08 21:46:08.292813 - 0:00:02 - Running on dp rank : 0
0: INFO    25-07-08 21:46:08.292858 - 0:00:02 - Running on dp size : 2
0: INFO    25-07-08 21:46:08.293295 - 0:00:02 - Building model
0: INFO    25-07-08 21:46:08.311835 - 0:00:02 - Initializing PE_VisionTransformer with args: {'image_size': 448, 'patch_size': 14, 'width': 1024, 'layers': 23, 'heads': 16, 'use_cls_token': True, 'use_abs_posemb': True, 'mlp_ratio': 4.0, 'ls_init_value': 0.1, 'drop_path': 0.1, 'use_ln_post': False, 'pool_type': 'none'}
0: INFO    25-07-08 21:46:08.333697 - 0:00:02 - Model is built !
0: INFO    25-07-08 21:46:08.462579 - 0:00:03 - Loading initial model from /home/oberon/.cache/huggingface/hub/models--facebook--Perception-LM-3B/snapshots/b54263fbbb6f7590c89b9c3036a9a9d03ad8441f
0: INFO    25-07-08 21:46:14.943738 - 0:00:09 - Model size: 3,516,753,920 total parameters
0: INFO    25-07-08 21:46:14.951073 - 0:00:09 - GPU capacity: NVIDIA GeForce RTX 3090 (0) with 23.55GiB memory
0: INFO    25-07-08 21:46:14.952360 - 0:00:09 - GPU memory usage: NVIDIA GeForce RTX 3090 (0): 23.551025390625 GiB capacity, 16.37890625 GiB peak, 69.5464676307469% peak
0: INFO    25-07-08 21:46:14.952412 - 0:00:09 - Starting build of optimizer...
0: INFO    25-07-08 21:46:14.954043 - 0:00:09 - Done with build of optimizer.
0: INFO    25-07-08 21:46:14.954100 - 0:00:09 - VariableSizeImageTransform size: 448
0: INFO    25-07-08 21:46:14.954180 - 0:00:09 - ImageTransform size: 448
0: INFO    25-07-08 21:46:14.954234 - 0:00:09 - Initalized transforms with: vision_input_type: 'thumb+tile' and max_num_tiles: 36.
0: INFO    25-07-08 21:46:14.954281 - 0:00:09 - ImageTransform size: 448
0: INFO    25-07-08 21:46:15.011690 - 0:00:09 - Initializing JSONLDataset dummy_image on dataloader rank 0 and world size 8
0: INFO    25-07-08 21:46:15.063237 - 0:00:09 - Starting iteration 0 over apps/plm/datasets/image/annotations.jsonl ...
0: INFO    25-07-08 21:46:29.879184 - 0:00:24 - Logging Trainable Parameters after first step.
0: INFO    25-07-08 21:46:29.879479 - 0:00:24 - Params total: 3,516,753,920, Learnable: 304,004,096, Frozen: 3,212,749,824.
0: INFO    25-07-08 21:46:30.091997 - 0:00:24 - garbage collection
0: WARNING 25-07-08 21:47:58.949068 - 0:00:00 - Signal handler installed.
0: WARNING 25-07-08 21:47:58.957246 - 0:00:00 - WARNING: Setting MKL_SERVICE_FORCE_INTEL to GNU
0: WARNING 25-07-08 21:47:58.957333 - 0:00:00 - WARNING: Setting MKL_NUM_THREADS to 1
0: WARNING 25-07-08 21:47:58.957380 - 0:00:00 - WARNING: Setting ENABLE_INTRA_NODE_COMM to 0
0: WARNING 25-07-08 21:47:58.957425 - 0:00:00 - WARNING: Setting TORCH_NCCL_AVOID_RECORD_STREAMS to 1
0: WARNING 25-07-08 21:47:58.957461 - 0:00:00 - WARNING: Setting NCCL_IB_TIMEOUT to 22
0: WARNING 25-07-08 21:47:58.957504 - 0:00:00 - WARNING: Setting NCCL_DEBUG to WARN
0: WARNING 25-07-08 21:47:58.957548 - 0:00:00 - WARNING: Setting PYTORCH_CUDA_ALLOC_CONF to expandable_segments:True
0: WARNING 25-07-08 21:47:58.957597 - 0:00:00 - WARNING: Setting TRITON_CACHE_DIR to /tmp/tmpkzcdokg0
0: INFO    25-07-08 21:48:12.086174 - 0:00:13 - Run launched with torchrun, local rank: 0
0: INFO    25-07-08 21:48:12.088773 - 0:00:13 - ENV: environ({'SHELL': '/bin/bash', 'COLORTERM': 'truecolor', 'TERM_PROGRAM_VERSION': '1.101.2', 'CONDA_EXE': '/home/oberon/anaconda3/bin/conda', '_CE_M': '', 'LANGUAGE': 'en_GB:en', 'XML_CATALOG_FILES': 'file:///home/oberon/anaconda3/envs/perception_models/etc/xml/catalog file:///etc/xml/catalog', 'PIP_NO_USER': '1', 'PWD': '/home/oberon/projects/perception_models', 'GSETTINGS_SCHEMA_DIR': '/home/oberon/anaconda3/envs/perception_models/share/glib-2.0/schemas', 'LOGNAME': 'oberon', 'XDG_SESSION_TYPE': 'tty', 'CONDA_PREFIX': '/home/oberon/anaconda3/envs/perception_models', 'GSETTINGS_SCHEMA_DIR_CONDA_BACKUP': '', 'VSCODE_GIT_ASKPASS_NODE': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/node', 'MOTD_SHOWN': 'pam', 'HOME': '/home/oberon', 'LANG': 'en_GB.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'SSL_CERT_DIR': '/usr/lib/ssl/certs', 'CONDA_PROMPT_MODIFIER': '(perception_models) ', 'GIT_ASKPASS': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/extensions/git/dist/askpass.sh', 'SSH_CONNECTION': '192.168.82.204 49630 131.227.186.152 22', 'VSCODE_GIT_ASKPASS_EXTRA_ARGS': '', 'LESSCLOSE': '/usr/bin/lesspipe %s %s', 'XDG_SESSION_CLASS': 'user', 'TERM': 'xterm-256color', '_CE_CONDA': '', 'LESSOPEN': '| /usr/bin/lesspipe %s', 'USER': 'oberon', 'VSCODE_GIT_IPC_HANDLE': '/run/user/1012/vscode-git-d917f49fae.sock', 'CONDA_SHLVL': '2', 'SHLVL': '2', 'XDG_SESSION_ID': '706', 'CONDA_PYTHON_EXE': '/home/oberon/anaconda3/bin/python', 'LD_LIBRARY_PATH': '/usr/local/cuda-12.9/lib64:/usr/local/cuda-11.8/lib64:', 'XDG_RUNTIME_DIR': '/run/user/1012', 'SSL_CERT_FILE': '/usr/lib/ssl/certs/ca-certificates.crt', 'SSH_CLIENT': '192.168.82.204 49630 22', 'CONDA_DEFAULT_ENV': 'perception_models', 'VSCODE_GIT_ASKPASS_MAIN': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/extensions/git/dist/askpass-main.js', 'CUDA_HOME': '/usr/local/cuda-12.9', 'XDG_DATA_DIRS': '/usr/local/share:/usr/share:/var/lib/snapd/desktop', 'BROWSER': '/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/bin/helpers/browser.sh', 'PATH': '/usr/local/cuda-12.9/bin:/usr/local/cuda-11.8/bin:/home/oberon/anaconda3/envs/perception_models/bin:/home/oberon/anaconda3/condabin:/home/oberon/.vscode-server/cli/servers/Stable-2901c5ac6db8a986a5666c3af51ff804d05af0d4/server/bin/remote-cli:/home/oberon/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/oberon/.vscode-server/data/User/globalStorage/github.copilot-chat/debugCommand', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/1012/bus', 'CONDA_PREFIX_1': '/home/oberon/anaconda3', 'TERM_PROGRAM': 'vscode', 'VSCODE_IPC_HOOK_CLI': '/run/user/1012/vscode-ipc-8f97b332-6577-40f8-b722-7d60be3f5e0a.sock', '_': '/home/oberon/anaconda3/envs/perception_models/bin/torchrun', 'OMP_NUM_THREADS': '1', 'LOCAL_RANK': '0', 'RANK': '0', 'GROUP_RANK': '0', 'ROLE_RANK': '0', 'ROLE_NAME': 'default', 'LOCAL_WORLD_SIZE': '2', 'WORLD_SIZE': '2', 'GROUP_WORLD_SIZE': '1', 'ROLE_WORLD_SIZE': '2', 'MASTER_ADDR': '127.0.0.1', 'MASTER_PORT': '29500', 'TORCHELASTIC_RESTART_COUNT': '0', 'TORCHELASTIC_MAX_RESTARTS': '0', 'TORCHELASTIC_RUN_ID': 'none', 'TORCHELASTIC_USE_AGENT_STORE': 'True', 'TORCH_NCCL_ASYNC_ERROR_HANDLING': '1', 'TORCHELASTIC_ERROR_FILE': '/tmp/torchelastic_h4mjuqd7/none_yheyzzra/attempt_0/0/error.json', 'CUDA_MODULE_LOADING': 'LAZY', 'MKL_SERVICE_FORCE_INTEL': 'GNU', 'MKL_NUM_THREADS': '1', 'ENABLE_INTRA_NODE_COMM': '0', 'TORCH_NCCL_AVOID_RECORD_STREAMS': '1', 'NCCL_IB_TIMEOUT': '22', 'NCCL_DEBUG': 'WARN', 'PYTORCH_CUDA_ALLOC_CONF': 'expandable_segments:True', 'TRITON_CACHE_DIR': '/tmp/tmpkzcdokg0'})
0: INFO    25-07-08 21:48:12.154120 - 0:00:13 - Starting job: plm_3b_stage3
0: INFO    25-07-08 21:48:12.160559 - 0:00:13 - Running on dp rank : 0
0: INFO    25-07-08 21:48:12.161958 - 0:00:13 - Running on dp size : 2
0: INFO    25-07-08 21:48:12.170014 - 0:00:13 - Building model
0: INFO    25-07-08 21:48:12.416599 - 0:00:13 - Initializing PE_VisionTransformer with args: {'image_size': 448, 'patch_size': 14, 'width': 1024, 'layers': 23, 'heads': 16, 'use_cls_token': True, 'use_abs_posemb': True, 'mlp_ratio': 4.0, 'ls_init_value': 0.1, 'drop_path': 0.1, 'use_ln_post': False, 'pool_type': 'none'}
0: INFO    25-07-08 21:48:12.754951 - 0:00:14 - Model is built !
0: INFO    25-07-08 21:48:13.420374 - 0:00:14 - Loading initial model from /home/oberon/.cache/huggingface/hub/models--facebook--Perception-LM-3B/snapshots/b54263fbbb6f7590c89b9c3036a9a9d03ad8441f
0: INFO    25-07-08 21:48:45.036602 - 0:00:46 - Model size: 3,516,753,920 total parameters
0: INFO    25-07-08 21:48:45.048796 - 0:00:46 - GPU capacity: NVIDIA GeForce RTX 3090 (0) with 23.55GiB memory
0: INFO    25-07-08 21:48:45.061615 - 0:00:46 - GPU memory usage: NVIDIA GeForce RTX 3090 (0): 23.551025390625 GiB capacity, 16.37890625 GiB peak, 69.5464676307469% peak
0: INFO    25-07-08 21:48:45.063500 - 0:00:46 - Starting build of optimizer...
0: INFO    25-07-08 21:48:45.087186 - 0:00:46 - Done with build of optimizer.
0: INFO    25-07-08 21:48:45.089281 - 0:00:46 - VariableSizeImageTransform size: 448
0: INFO    25-07-08 21:48:45.090575 - 0:00:46 - ImageTransform size: 448
0: INFO    25-07-08 21:48:45.091465 - 0:00:46 - Initalized transforms with: vision_input_type: 'thumb+tile' and max_num_tiles: 36.
0: INFO    25-07-08 21:48:45.091964 - 0:00:46 - ImageTransform size: 448
0: INFO    25-07-08 21:48:45.273895 - 0:00:46 - Initializing JSONLDataset dummy_image on dataloader rank 0 and world size 8
0: INFO    25-07-08 21:48:45.621015 - 0:00:47 - Starting iteration 0 over apps/plm/datasets/image/annotations.jsonl ...
0: INFO    25-07-08 21:48:46.377468 - 0:00:47 - Logging Trainable Parameters after first step.
0: INFO    25-07-08 21:48:46.377821 - 0:00:47 - Params total: 3,516,753,920, Learnable: 304,004,096, Frozen: 3,212,749,824.
0: WARNING 25-07-08 21:54:04.492922 - 0:06:06 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (0/8): None
0: INFO    25-07-08 21:54:04.493247 - 0:06:06 - Starting iteration 1 over apps/plm/datasets/image/annotations.jsonl ...
0: WARNING 25-07-08 21:54:17.417740 - 0:06:18 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (1/8): None
0: WARNING 25-07-08 21:54:24.088021 - 0:06:25 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (2/8): None
0: WARNING 25-07-08 21:59:27.110978 - 0:11:28 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (0/8): None
0: INFO    25-07-08 21:59:27.111501 - 0:11:28 - Starting iteration 2 over apps/plm/datasets/image/annotations.jsonl ...
0: WARNING 25-07-08 21:59:51.412307 - 0:11:52 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (1/8): None
0: WARNING 25-07-08 22:00:05.874224 - 0:12:07 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (2/8): None
0: WARNING 25-07-08 22:04:47.410627 - 0:16:48 - Setting JSONL position on apps/plm/datasets/image/annotations.jsonl (0/8): None
0: INFO    25-07-08 22:04:47.410948 - 0:16:48 - Starting iteration 3 over apps/plm/datasets/image/annotations.jsonl ...
